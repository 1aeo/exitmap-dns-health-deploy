# exitmap DNS Health Validation Configuration
# Copy to config.env and edit with your values:
#   cp config.env.example config.env

# =============================================================================
# CLOUDFLARE (Required for Pages deployment)
# =============================================================================
CLOUDFLARE_ACCOUNT_ID=your_cloudflare_account_id
CLOUDFLARE_API_TOKEN=your_cloudflare_api_token
PAGES_PROJECT_NAME=exitdnshealth
CUSTOM_DOMAIN=exitdnshealth.example.com

# =============================================================================
# STORAGE (Multi-backend with failover)
# =============================================================================
# Comma-separated list of backends in priority order: do,r2
STORAGE_ORDER=do,r2
CLOUD_UPLOAD=true

# --- DigitalOcean Spaces (Primary) ---
DO_ENABLED=true
DO_SPACES_BUCKET=your-bucket-name
DO_SPACES_KEY=your_spaces_access_key
DO_SPACES_SECRET=your_spaces_secret_key
DO_SPACES_REGION=nyc3
DO_SPACES_CDN=false

# --- Cloudflare R2 (Backup) ---
R2_ENABLED=true
R2_BUCKET=your-r2-bucket-name
R2_ACCESS_KEY_ID=your_r2_access_key_id
R2_SECRET_ACCESS_KEY=your_r2_secret_access_key

# =============================================================================
# CACHE TTL (seconds)
# =============================================================================
CACHE_TTL_LATEST=60
CACHE_TTL_HISTORICAL=31536000

# =============================================================================
# RCLONE SETTINGS
# =============================================================================
RCLONE_PATH=$HOME/bin/rclone
RCLONE_TRANSFERS=128
RCLONE_CHECKERS=256
DO_RCLONE_TRANSFERS=56
DO_RCLONE_CHECKERS=80

# =============================================================================
# PATHS
# =============================================================================
# DEPLOY_PATH: Root directory of this repository. Other paths reference it.
# Used by install-cron.sh to configure crontab automatically.
DEPLOY_PATH=$HOME/exitmap-dns-health-deploy
EXITMAP_DIR=$HOME/exitmap
OUTPUT_DIR=$DEPLOY_PATH/public
LOG_DIR=$DEPLOY_PATH/logs
BACKUP_DIR=$DEPLOY_PATH/backups
TMP_DIR=$DEPLOY_PATH/tmp

# =============================================================================
# SCAN SETTINGS
# =============================================================================
BUILD_DELAY=0
DELAY_NOISE=0
FIRST_HOP=
RELIABLE_FIRST_HOP=true
ALL_EXITS=true
# Grace period (seconds) to wait for straggling probes before terminating them
EXITMAP_GRACE_TIMEOUT=10

# =============================================================================
# DNS VALIDATION SETTINGS
# =============================================================================
# Your DNS infrastructure for exit relay validation
DNS_WILDCARD_DOMAIN=tor.exit.validator.example.com
DNS_EXPECTED_IP=192.0.2.1
DNS_QUERY_TIMEOUT=45
DNS_MAX_RETRIES=3
DNS_HARD_TIMEOUT=180
DNS_RETRY_DELAY=1.0

# =============================================================================
# AUTOMATION
# =============================================================================
CLEANUP_OLD=true
ANALYSIS_KEEP_COUNT=3
# Cron schedule for DNS validation scans (used by install-cron.sh)
# Default: every 2 hours at :15
CRON_SCHEDULE="15 */2 * * *"

# Tor bootstrap retry settings
TOR_BOOTSTRAP_TIMEOUT=90
TOR_MAX_BOOTSTRAP_RETRIES=3
TOR_PROGRESS_CHECK_INTERVAL=10
